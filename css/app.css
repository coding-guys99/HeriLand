:root{
  --bg: #FAF6EF;
  --card: #FFFFFF;
  --line: rgba(0,0,0,.08);
  --text: #1A1A1A;
  --muted: rgba(0,0,0,.55);
  --accent: #2E5E4E;
  --gold: #E4C77D;
  --radius: 14px;
  --shadow: 0 6px 24px rgba(0,0,0,.08);
  --appbar-height: 56px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:"Inter","Noto Sans TC","Noto Sans SC",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  line-height:1.6;
  padding-bottom:calc(76px + env(safe-area-inset-bottom));
}
img{max-width:100%;display:block}
a{color:inherit;text-decoration:none}
.container{max-width:1200px;margin:0 auto;padding:0 16px}

/* ===== AppBar（Hello + 搜尋 icon） ===== */
.appbar{position:sticky;top:0;z-index:40;background:var(--bg);border-bottom:1px solid var(--line);}
.appbar-inner{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 12px;}
.greet{display:flex;flex-direction:column;line-height:1;padding-left:2px;}
.greet strong{font-weight:800;letter-spacing:.2px;font-size:1.1rem;}
.greet .sub{font-size:12px;color:var(--muted);margin-top:2px;}
.search-trigger{background:transparent;border:0;font-size:22px;line-height:1;cursor:pointer;}

/* ===== Hero / Chips / Rows ===== */
.hero-rail{padding:8px 0;}
.hero-rail .rail{
  display:grid;grid-auto-flow:column;grid-auto-columns:80%;gap:10px;
  overflow-x:auto;padding:0 12px;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch;
}
.hero-card{position:relative;display:block;border-radius:16px;overflow:hidden;scroll-snap-align:start;box-shadow:var(--shadow);}
.hero-card img{width:100%;height:120px;object-fit:cover;display:block}
.hero-caption{position:absolute;left:8px;bottom:8px;right:8px;color:#fff;font-weight:700;text-shadow:0 2px 8px rgba(0,0,0,.45);}
.hero-caption .ad{font-style:normal;font-weight:700;font-size:11px;margin-left:6px;padding:2px 6px;border-radius:999px;background:rgba(0,0,0,.55);}

.section{padding:28px 0}
.mobile-app .chips-row{
  display:grid;grid-auto-flow:column;grid-auto-columns:max-content;overflow-x:auto;gap:8px;
  padding:0 12px 6px;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch;
}
.chips-row .chip{
  background:var(--card);border:1px solid var(--line);border-radius:999px;padding:8px 12px;
  box-shadow:var(--shadow);cursor:pointer;scroll-snap-align:start;
}
.chips-row .chip:hover{transform:translateY(-1px)}

.rows .row-section{padding:10px 0 4px;}
.row-head{display:flex;align-items:baseline;justify-content:space-between;padding:0 12px 6px;}
.row-head h2{margin:0;font-size:16px}
.row-head .see-all{font-size:12px;color:var(--accent)}
.rail{display:grid;grid-auto-flow:column;grid-auto-columns:38%;gap:10px;overflow-x:auto;padding:0 12px 4px;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch;}
.rail>*{scroll-snap-align:start}

/* ===== Card styles ===== */
.card{
  background:linear-gradient(180deg,rgba(255,255,255,.9),rgba(255,255,255,.96));
  backdrop-filter:blur(6px);
  border:1px solid rgba(255,255,255,.7);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  overflow:hidden;
  transition:transform .15s ease;
}
.card:hover{transform:translateY(-2px);}
.card .thumb{background:#ddd}
.card.poster .thumb{aspect-ratio:2/3;border-radius:12px;box-shadow:var(--shadow);}
.card.poster .t{margin:6px 2px 0;font-size:13px;line-height:1.3;}
.card.mini .thumb{aspect-ratio:16/9;border-radius:12px;box-shadow:var(--shadow);}
.card .meta{display:flex;gap:8px;align-items:center;color:var(--muted);font-size:.92rem;}
.card .meta span{background:#fff;border:1px solid var(--line);border-radius:999px;padding:2px 8px;}

/* ===== Modal ===== */
.modal-backdrop{
  position:fixed;inset:0;background:rgba(0,0,0,.45);
  display:grid;place-items:center;padding:24px;z-index:100;
  opacity:0;transition:opacity .22s ease;
}
.modal-backdrop[aria-hidden="false"]{opacity:1;}
.modal-backdrop[hidden]{display:none!important;}
.modal-dialog{
  position:relative;width:min(920px,100%);background:var(--card);color:var(--text);
  border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow);overflow:hidden;
  max-height:90vh;display:grid;grid-template-columns:1fr;
  transform:translateY(6px) scale(.985);opacity:0;transition:transform .24s ease,opacity .24s ease;
}
.modal-backdrop[aria-hidden="false"] .modal-dialog{transform:translateY(0) scale(1);opacity:1;}
.modal-close{
  position:absolute;right:8px;top:8px;z-index:200;margin:10px;
  border:1px solid var(--line);background:#fff;border-radius:999px;width:36px;height:36px;cursor:pointer;
}
.modal-gallery{display:grid;grid-auto-flow:column;grid-auto-columns:100%;overflow-x:auto;scroll-snap-type:x mandatory;}
.modal-gallery img{width:100%;height:auto;display:block;aspect-ratio:16/9;object-fit:cover;scroll-snap-align:start;}
.modal-body{padding:16px 16px 20px;}
.place-meta{display:flex;gap:12px;color:var(--muted);margin:6px 0 10px;}
.place-info{display:grid;gap:6px;margin:10px 0 12px;}
.action-row{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px;}
.btn.action{
  background:var(--card);border:1px solid var(--line);border-radius:12px;
  padding:8px 12px;cursor:pointer;display:inline-flex;align-items:center;gap:6px;
}

/* ===== TabBar（中置膠囊） ===== */
.tabbar{
  position:fixed;left:0;right:0;bottom:0;z-index:1000;
  padding:8px 10px calc(8px + env(safe-area-inset-bottom));
  display:flex;justify-content:center;background:transparent;
}
.tabbar .tab{
  appearance:none;border:0;margin:0;height:48px;width:48px;border-radius:999px;
  display:inline-flex;align-items:center;justify-content:center;
  background:transparent;color:#233;cursor:pointer;position:relative;
}
.tabbar .ico{font-size:20px;line-height:1}
.tabbar .tab.active{
  background:rgba(255,255,255,.9);
  box-shadow:inset 0 0 0 1px rgba(0,0,0,.06),0 6px 12px rgba(0,0,0,.08);
}
.tabbar .tab.active::after{
  content:"";position:absolute;bottom:4px;width:6px;height:6px;border-radius:50%;background:#2E5E4E;
}
.tabbar--capsule{pointer-events:none;}
.tabbar--capsule>*{pointer-events:auto;}
.tabbar--capsule .bg{
  position:absolute;left:50%;transform:translateX(-50%);
  bottom:calc(8px + env(safe-area-inset-bottom));
  width:min(92%,480px);height:56px;z-index:0;
  background:color-mix(in srgb,#ffffff 86%,transparent);
  -webkit-backdrop-filter:blur(16px) saturate(120%);
  backdrop-filter:blur(16px) saturate(120%);
  border:1px solid rgba(0,0,0,.06);border-radius:999px;
  box-shadow:0 6px 22px rgba(0,0,0,.12);
}
@media (prefers-color-scheme:dark){
  .tabbar--capsule .bg{
    background:color-mix(in srgb,#0b0f12 55%,transparent);
    border-color:rgba(255,255,255,.08);
  }
  .tabbar .tab{color:#f7f7f7;}
}

/* ===== 全螢幕搜尋 Overlay（抖音式） ===== */
.overlay-glass{
  position:fixed;inset:0;z-index:1100;
  background:color-mix(in srgb,rgba(15,18,21,.55) 100%,transparent);
  -webkit-backdrop-filter:blur(18px) saturate(120%);
  backdrop-filter:blur(18px) saturate(120%);
  opacity:0;transform:translateY(-10px);
  transition:opacity .25s ease,transform .25s ease;
  pointer-events:none;
}
.overlay-glass.active{opacity:1;transform:translateY(0);pointer-events:auto;}
.overlay-glass[hidden]{display:none!important;}
.search-bar{display:flex;align-items:center;gap:8px;padding:12px;background:transparent;}
.search-input{
  display:flex;align-items:center;gap:8px;flex:1;
  padding:10px 12px;border:1px solid rgba(255,255,255,.18);
  border-radius:12px;background:color-mix(in srgb,rgba(255,255,255,.92) 100%,transparent);
  -webkit-backdrop-filter:blur(10px) saturate(120%);
  backdrop-filter:blur(10px) saturate(120%);
}
.search-input input{flex:1;border:0;outline:0;background:transparent;font-size:16px;color:#111;}
.search-cancel{appearance:none;border:0;background:transparent;color:#fff;font-weight:600;padding:8px 6px;cursor:pointer;}
.search-scroll{
  height:calc(100vh - var(--appbar-height));
  overflow:auto;padding-bottom:calc(16px + env(safe-area-inset-bottom));
}
.search-hint{color:#e8e8e8;opacity:.9;font-size:12px;padding:2px 10px 8px}
.search-item{
  display:flex;gap:10px;align-items:center;
  background:color-mix(in srgb,#ffffff 92%,transparent);
  border:1px solid rgba(0,0,0,.06);border-radius:12px;padding:10px;margin:8px 6px;
  -webkit-backdrop-filter:blur(10px) saturate(120%);backdrop-filter:blur(10px) saturate(120%);
}
.search-thumb{width:72px;height:56px;border-radius:10px;background:#ddd center/cover no-repeat;flex:none;}
.search-main{min-width:0;flex:1;}
.search-title{font-weight:700;font-size:15px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.search-sub{color:#555;font-size:12px;margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.search-tags{color:#888;font-size:12px;margin-top:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.search-meta{color:#444;font-size:12px;margin-left:6px;white-space:nowrap;}

@media (prefers-color-scheme:dark){
  .search-item{border-color:rgba(255,255,255,.08);background:color-mix(in srgb,#0b0f12 70%,transparent);}
  .search-sub,.search-tags{color:#cfd6dc;}
  .search-meta{color:#dfe5ea;}
}

/* ===== Toast & Footer ===== */
#toasts{position:fixed;left:0;right:0;bottom:calc(74px + env(safe-area-inset-bottom));display:grid;gap:8px;justify-items:center;z-index:1300;pointer-events:none;}
.toast{background:rgba(0,0,0,.85);color:#fff;padding:10px 12px;border-radius:12px;transform:translateY(8px);opacity:0;transition:.2s ease;max-width:88%;text-align:center;pointer-events:auto;}
.toast.in{transform:translateY(0);opacity:1;}
.site-footer{border-top:1px solid var(--line);margin-top:28px;}
.footer-row{display:flex;align-items:center;justify-content:space-between;padding:16px 0;}

/* === Search — visual polish patch ======================== */
/* 背景玻璃＋上下柔光 */
.overlay-glass{
  background:
    radial-gradient(100% 40% at 50% 0%, rgba(255,255,255,.16), transparent 60%),
    color-mix(in srgb, rgba(15,18,21,.55) 100%, transparent);
}

/* 頂部搜尋列：黏在頂部、玻璃、聚焦高光 */
.search-bar{
  position: sticky; top: 0; z-index: 1;
  padding: 10px 12px 8px;
  backdrop-filter: blur(6px);
}
.search-input{
  position: relative;
  display:flex; align-items:center; gap:8px; flex:1;
  padding: 10px 12px; border:1px solid rgba(0,0,0,.12);
  border-radius: 12px;
  background: color-mix(in srgb, #ffffff 92%, transparent);
  box-shadow: 0 6px 18px rgba(0,0,0,.08);
}
.search-input::before{
  content:"🔍"; opacity:.7; font-size:14px;
  position:absolute; left:10px;
}
.search-input input{
  flex:1; border:0; outline:0; background:transparent;
  font-size:16px; color:#111; padding-left: 22px; /* 騰給 icon */
}
.search-input:focus-within{
  border-color: rgba(46,94,78,.35);
  box-shadow: 0 6px 22px rgba(46,94,78,.12), inset 0 0 0 1px rgba(46,94,78,.18);
}

/* 右側 Cancel – 與輸入框垂直置中、點擊區大一點 */
.search-cancel{
  margin-left: 8px;
  font-weight: 700;
  letter-spacing: .2px;
  padding: 8px 6px;
}

/* 結果區（確保是直向單欄、可滾動） */
.search-scroll{
  height: calc(100vh - var(--appbar-height));
  overflow: auto;
  padding: 6px 6px calc(16px + env(safe-area-inset-bottom));
}
.search-hint{
  color: #e8e8e8; opacity: .95;
  font-size: 12px; padding: 2px 12px 8px;
}

/* 結果清單固定單列寬度（不要像膠囊換行） */
.search-list{ display: block; }
.search-item{
  width: auto;                       /* 佔滿父層 */
  display: grid;
  grid-template-columns: 88px 1fr auto; /* 縮圖 / 文案 / 評分 */
  align-items: center;
  gap: 12px;
  padding: 12px;
  margin: 8px 6px;
  border: 1px solid rgba(0,0,0,.06);
  border-radius: 14px;
  background: color-mix(in srgb, #ffffff 96%, transparent);
  box-shadow: 0 10px 22px rgba(0,0,0,.08);
  transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
}
.search-item:hover{
  box-shadow: 0 14px 28px rgba(0,0,0,.12);
}
.search-item:active{
  transform: translateY(1px);
}

/* 縮圖固定、圓角更柔和 */
.search-thumb{
  width: 88px; height: 64px; border-radius: 12px;
  background: #ddd center/cover no-repeat;
}

/* 文案：標題兩行收斂、副標一行、標籤次要 */
.search-main{ min-width:0; display:flex; flex-direction:column; gap:4px; }
.search-title{
  font-weight: 800; font-size: 16px; line-height: 1.15;
  overflow:hidden; text-overflow:ellipsis; display:-webkit-box;
  -webkit-line-clamp:2; -webkit-box-orient:vertical; white-space:normal;
}
.search-sub{
  color:#58616a; font-size:12px; line-height:1.2;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.search-tags{
  color:#7b8691; font-size:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}

/* 右側評分：對齊不飄、字重清楚 */
.search-meta{
  margin-left: 8px;
  font-weight: 800; font-size: 13px; color:#1d2a2a;
  display: inline-flex; align-items: center; gap: 6px;
}
.search-meta::before{ content: "⭐"; }

/* 暗色保護 */
@media (prefers-color-scheme: dark){
  .search-input{ border-color: rgba(255,255,255,.12); background: color-mix(in srgb, #0b0f12 70%, transparent); }
  .search-input:focus-within{ box-shadow: 0 6px 22px rgba(255,255,255,.09), inset 0 0 0 1px rgba(255,255,255,.18); }
  .search-item{ border-color: rgba(255,255,255,.08); background: color-mix(in srgb, #0b0f12 74%, transparent); }
  .search-sub{ color:#cfd6dc }
  .search-tags{ color:#aeb7bf }
  .search-meta{ color:#e7edf2 }
}